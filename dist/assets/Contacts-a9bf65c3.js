import{_ as h,r as d,o as r,c as i,a as t,t as l,d as m,w as v,F as y,e as g,f as x,n as f,g as p,b as C,h as B,v as b,i as k,j as w}from"./index-ef6ac8cc.js";const D={props:{contact:{type:Object,required:!0}},emits:["deleteContact"],methods:{deleteContact(e){this.$emit("deleteContact",e)}}},F={class:"contact-preview card"},M={class:"contact-email"},O={class:"contact-phone"},U={class:"button-container flex"},A=t("button",null,"Details",-1);function L(e,s,a,_,n,c){const o=d("RouterLink");return r(),i("article",F,[t("h3",null,l(a.contact.name),1),t("p",M,l(a.contact.email),1),t("p",O,l(a.contact.phone),1),t("div",U,[m(o,{to:`/contact/${a.contact._id}`},{default:v(()=>[A]),_:1},8,["to"]),t("button",{onClick:s[0]||(s[0]=u=>c.deleteContact(a.contact._id))},"Delete")])])}const V=h(D,[["render",L]]),N={props:{contacts:{type:Array,default:[]}},emits:["deleteContact"],components:{ContactPreview:V},methods:{deleteContact(e){this.$emit("deleteContact",e)}}},S={class:"contact-list"};function j(e,s,a,_,n,c){const o=d("ContactPreview");return r(),i("ul",S,[(r(!0),i(y,null,g(a.contacts,u=>(r(),i("li",null,[m(o,{onDeleteContact:c.deleteContact,contact:u},null,8,["onDeleteContact","contact"])]))),256))])}const P=h(N,[["render",j]]),q={props:["filterBy"],emits:["update:filterBy","termUpdated"],created(){this.debouncedUpdate=x.debounce(this.update,400)},methods:{update(e){this.$emit("update:filterBy",{term:e.target.value}),this.$emit("termUpdated")}}},I={class:"contact-filter card"},R=["value"];function z(e,s,a,_,n,c){return r(),i("form",I,[t("input",{onInput:s[0]||(s[0]=(...o)=>e.debouncedUpdate&&e.debouncedUpdate(...o)),value:a.filterBy.term,type:"text",name:"text",placeholder:"Search for..."},null,40,R)])}const E=h(q,[["render",z]]),Q={data(){return{chosenContact:null,amount:0,isMsgOn:!1,msg:"",msgType:""}},computed:{userBalance(){return this.$store.getters.user.balance}},props:{contacts:{required:!0,type:Array}},methods:{setChosenContact(e){this.chosenContact=e},isChosen(e){var s;return((s=this.chosenContact)==null?void 0:s._id)===e},async makeTransfer(){if(this.$store.getters.user.balance-this.amount<0){this.msg="Transfer exceeds funds",this.isMsgOn=!0,this.msgType="error",setTimeout(()=>{this.msg="",this.isMsgOn=!1,this.msgType=""},2500);return}this.$store.dispatch({type:"chargeAmount",amount:this.amount,toId:this.chosenContact._id,to:this.chosenContact.name}),await this.$store.dispatch({type:"contactAddAmount",contact:this.chosenContact,amount:this.amount,from:this.$store.getters.user.name}),this.chosenContact=null,this.amount=0,this.msg="Transfer successful!",this.isMsgOn=!0,this.msgType="success",setTimeout(()=>{this.msg="",this.isMsgOn=!1,this.msgType="success"},2500)}}},G={class:"contacts-transfer-funds card"},H={class:"transfer-container flex column justify-between"},J=t("h3",null,"Quick transfer",-1),K={key:0},W={class:"dynamic"},X={class:"p-amount flex"},Y=["max"],Z=t("img",{src:"https://cdn-icons-png.flaticon.com/512/5968/5968260.png"},null,-1),tt={class:"card"},et=["onClick"];function st(e,s,a,_,n,c){return r(),i("section",G,[t("div",H,[t("header",null,[J,n.isMsgOn?(r(),i("p",{key:0,class:f({msg:n.msg,error:n.msgType==="error",success:n.msgType==="success"})},l(n.msg),3)):p("",!0)]),n.chosenContact?(r(),i("form",K,[t("p",null,[C(" Transfer to "),t("span",W,l(n.chosenContact.name),1)]),t("p",X,[C(" An amonut of "),B(t("input",{class:"card","onUpdate:modelValue":s[0]||(s[0]=o=>n.amount=o),type:"number",min:0,max:c.userBalance},null,8,Y),[[b,n.amount]]),Z]),t("button",{onClick:s[1]||(s[1]=k((...o)=>c.makeTransfer&&c.makeTransfer(...o),["prevent"]))},"Transfer")])):p("",!0)]),t("ul",tt,[(r(!0),i(y,null,g(a.contacts,o=>(r(),i("li",{class:f({chosen:c.isChosen(o._id)}),onClick:u=>c.setChosenContact(o)},[t("p",null,l(o.name),1)],10,et))),256))])])}const nt=h(Q,[["render",st]]),ot={data(){return{filterBy:{term:""}}},components:{ContactList:P,ContactFilter:E,ContactsTransferFunds:nt},computed:{contacts(){return this.$store.getters.contacts},filteredContacts(){return w.filterContacts(this.contacts,this.filterBy)}},async created(){await this.$store.dispatch({type:"loadContacts"})},methods:{async deleteContact(e){await this.$store.dispatch({type:"removeContact",contactId:e}),console.log("this.contacts",this.contacts)}}},ct={class:"contacts"},at=t("h1",null,"Contacts",-1),rt={class:"contacts-container"};function it(e,s,a,_,n,c){const o=d("ContactFilter"),u=d("ContactList"),$=d("ContactsTransferFunds");return r(),i("main",ct,[at,m(o,{filterBy:n.filterBy,"onUpdate:filterBy":s[0]||(s[0]=T=>n.filterBy=T)},null,8,["filterBy"]),t("section",rt,[m(u,{onDeleteContact:c.deleteContact,contacts:c.filteredContacts},null,8,["onDeleteContact","contacts"]),m($,{contacts:c.filteredContacts},null,8,["contacts"])])])}const ut=h(ot,[["render",it]]);export{ut as default};
